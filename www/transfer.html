<html>
	
    <head>      
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		
			<script language="JavaScript" type="text/javascript" src="js/seq/aes.js"></script>
					<script language="JavaScript" type="text/javascript" src="js/seq/jsbn.js"></script>
							<script language="JavaScript" type="text/javascript" src="js/seq/random.js"></script>
									<script language="JavaScript" type="text/javascript" src="js/seq/hash.js"></script>
											<script language="JavaScript" type="text/javascript" src="js/seq/rsa.js"></script>
													<script language="JavaScript" type="text/javascript" src="js/seq/api.js"></script>
<script language="JavaScript" type="text/javascript" src="js/seq/cryptico.js"></script>													
															<script language="JavaScript" type="text/javascript" src="js/js-sha256.js"></script>
        <script language="JavaScript" type="text/javascript" src="js/client.js"></script>
		<script>	
	

		
		function init() {
			loadKey();
			loadNodeName();
			client.loadServerPublicKey();
		}

		function send() {
			showMessage('');
			var recipient = document.getElementById('address-field').value;
			recipient = recipient.trim();
				
			if(recipient.length!=32) {
				showMessage('Wrong key');
				return;
			}
			var amount = document.getElementById('amount-field').value;
			client.transfer(client.privateKey, recipient, amount, client.publicKeyID, function(message) {			
				showMessage(message);
			});
		}
		
		function showMessage(message) {
			document.getElementById('status-field').value=message;
		}
			
        </script>
		<link rel="stylesheet" type="text/css" href="css/barcode.css">
    </head>
    
    <body style="font-family: monospace;" onload="init();">
	<div>
		<p style="text-align:center;"><img src="img/barcode_big.png"  style="width:50%" /></p>	
	</div>
		<div>
			<table  style="font-size:30px; width:100%; font-family:bold">
			<tr>
		    <td style="width:auto; text-align:left; white-space: nowrap">Destination</td><td style="width:100%;"><textarea id="address-field" style="width:100%; height:100px"></textarea></td>
			</tr>
			<tr>
			<td style="width:auto; text-align:left; white-space: nowrap">Amount</td><td style="width:100%;"><input id="amount-field" type="number" style="width:100%; height:50px"></td>
			</tr>
			<tr>
				<td style="width:auto; text-align:left; white-space: nowrap">Status</td><td style="width:100%;"><input id="status-field" type="text" disabled></td>
			</tr>
			</table>
		</div>
		 <div >
			  <button onclick="send();" class="btn-group">Transfer</button>		 
			  <button onclick="window.history.go(-1); return false;"class="btn-group">Back</button>
		</div> 
		<div style="width=100%">
			<p id="key-field" style="word-break: break-all;text-align:center;">Key:?</p>	
			<p id="node-field" style="word-break: break-all;text-align:center;">Node:?</p>	
		</div>
		<script type="text/javascript">
			var textArea = document.getElementById("address-field");
			textArea.addEventListener("keyup", sendCode);
			
			var textAmount = document.getElementById("amount-field");
			textAmount.addEventListener("keyup", sendCode);

			function sendCode(e) {
				var clickedEl = e.target;
				if(e.which == 13){
					clickedEl.blur();
					//rest of function
					return false;
				}
			}
		</script>
    </body>    
</html>